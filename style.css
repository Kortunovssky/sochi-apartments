// Данные апартаментов
const apartments = [
  {
    id: 1,
    title: "Морской бриз",
    location: "Сочи, Адлер",
    description: "Элитные апартаменты с панорамным видом на море, современный ремонт и инфраструктура премиум-класса.",
    image: "https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
    prices: [25000, 22000, 20000],
    features: ["Вид на море", "2 спальни", "Бассейн", "Парковка"],
    type: "sea-view"
  },
  {
    id: 2,
    title: "Центральный люкс",
    location: "Сочи, Центр",
    description: "Роскошные апартаменты в самом центре города с панорамными окнами и дизайнерским ремонтом.",
    image: "https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
    prices: [35000, 32000, 30000],
    features: ["Центр города", "3 спальни", "Консьерж-сервис", "Терраса"],
    type: "luxury"
  },
  {
    id: 3,
    title: "Горная вилла",
    location: "Красная Поляна",
    description: "Эксклюзивная вилла у подножья гор с частным садом и SPA-комплексом.",
    image: "https://images.unsplash.com/photo-1580587771525-78b9dba3b914?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
    prices: [50000, 45000, 40000],
    features: ["Горный вид", "4 спальни", "Частный бассейн", "Камин"],
    type: "villa"
  }
];

// Фильтры
const apartmentsFilter = [
  { name: "Все", active: true, type: "all" },
  { name: "С видом на море", active: false, type: "sea-view" },
  { name: "Люксы", active: false, type: "luxury" },
  { name: "Виллы", active: false, type: "villa" }
];

// Инициализация приложения
document.addEventListener('DOMContentLoaded', () => {
  renderFilters();
  renderApartments();
  setupEventListeners();
});

// Рендер фильтров
function renderFilters() {
  const filterContainer = document.querySelector('.apartments-filter ul');
  filterContainer.innerHTML = apartmentsFilter.map(filter => `
    <li class="${filter.active ? 'active' : ''}" data-type="${filter.type}">
      ${filter.name}
    </li>
  `).join('');
}

// Рендер апартаментов
function renderApartments(filterType = 'all') {
  const container = document.querySelector('.apartments-items');
  const filteredApartments = filterType === 'all' 
    ? apartments 
    : apartments.filter(apt => apt.type === filterType);
  
  container.innerHTML = filteredApartments.map(apartment => `
    <article class="apartment" id="apartment-${apartment.id}">
      <img src="${apartment.image}" alt="${apartment.title}" loading="lazy">
      <div class="apartment-details">
        <h4>${apartment.title}</h4>
        <p>${apartment.description}</p>
        <div class="apartment-action">
          <ul>
            <li>
              <div class="apartment-period">На 1 сутки</div>
              <div class="apartment-price">${apartment.prices[0].toLocaleString()} ₽</div>
            </li>
            <li>
              <div class="apartment-period">На 1-3 суток</div>
              <div class="apartment-price">${apartment.prices[1].toLocaleString()} ₽ <span>сут</span></div>
            </li>
            <li>
              <div class="apartment-period">3+ суток</div>
              <div class="apartment-price">${apartment.prices[2].toLocaleString()} ₽ <span>сут</span></div>
            </li>
          </ul>
          <a href="#booking" class="button white-button">Забронировать</a>
        </div>
      </div>
    </article>
  `).join('');
}

// Настройка обработчиков событий
function setupEventListeners() {
  // Фильтрация
  document.querySelectorAll('.apartments-filter li').forEach(item => {
    item.addEventListener('click', () => {
      const type = item.dataset.type;
      document.querySelectorAll('.apartments-filter li').forEach(li => {
        li.classList.remove('active');
      });
      item.classList.add('active');
      renderApartments(type);
    });
  });

  // Бронирование
  document.querySelectorAll('.white-button').forEach(button => {
    button.addEventListener('click', (e) => {
      const apartmentTitle = e.target.closest('.apartment').querySelector('h4').textContent;
      // Здесь можно добавить логику бронирования
      console.log(`Бронирование: ${apartmentTitle}`);
    });
  });
}

// Полифиллы для старых браузеров
if (!NodeList.prototype.forEach) {
  NodeList.prototype.forEach = Array.prototype.forEach;
}
